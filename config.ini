# Camera Calibration Configuration File

[cameras]
# Camera device indices
left = 0
right = 1

[capture]
# Camera capture settings
exposure_time = 250000
analogue_gain = 1.0
capture_interval = 2
image_size_width = 1920
image_size_height = 1080

# Camera transformations
hflip = 0
vflip = 0

[aruco]
# ArUco marker detection settings
dictionary = DICT_6X6_100
marker_dimensions_width = 8
marker_dimensions_height = 5
square_length = 0.05
marker_length = 0.037
marker_colour_b = 0
marker_colour_g = 0
marker_colour_r = 255

# Marker detection parameters
corner_refinement = CORNER_REFINE_SUBPIX
markers_required_ratio = 0.9

[calibration]
# Calibration settings
rectification_alpha = 0.25
rectification_alpha_left = 0.2
rectification_alpha_right = 0.2

# Fisheye calibration
fisheye = false
fisheye_balance = 1.0

# Individual camera calibration flags (applies to left and right calibration)

# Use intrinsic guess as starting point for optimization
# USE: If you have approximate calibration values to start from
# DON'T USE: On first calibration (no guess available)
calib_use_intrinsic_guess = false

# Fix principal point at image center during optimization
# USE: If lens is well-centered (reduces parameters to optimize)
# DON'T USE: If principal point offset is significant
calib_fix_principal_point = false

# Fix aspect ratio (fx/fy = 1 or initial guess)
# USE: If pixels are square or you want to enforce square pixels
# DON'T USE: If sensor has non-square pixels or aspect ratio is important
calib_fix_aspect_ratio = false

# Set tangential distortion (p1, p2) to zero
# USE: For lenses with primarily radial distortion (most lenses)
# DON'T USE: If decentering distortion is significant
calib_zero_tangent_dist = true

# Enable rational distortion model (k1-k6, p1-p2) - 8 coefficients
# USE: For wide-angle or fisheye lenses with high distortion
# DON'T USE: For normal lenses (5 coefficients sufficient), adds complexity
calib_rational_model = true

# Enable thin prism distortion model (s1, s2, s3, s4)
# USE: For lenses with manufacturing defects causing prism distortion
# DON'T USE: For standard lenses (rarely needed)
calib_thin_prism_model = false

# Enable tilted sensor model (tauX, tauY)
# USE: If sensor plane is not perpendicular to optical axis
# DON'T USE: For standard cameras (rare manufacturing defect)
calib_tilted_model = false

# Fix focal length during optimization (fx, fy)
# USE: If you know exact focal length from lens specifications
# DON'T USE: During normal calibration (focal length should be optimized)
calib_fix_focal_length = false

# Fix individual distortion coefficients k1-k6
# USE: If you want to constrain specific distortion parameters
# DON'T USE: During normal calibration (should be optimized)
calib_fix_k1 = false
calib_fix_k2 = false
calib_fix_k3 = false
calib_fix_k4 = false
calib_fix_k5 = false
calib_fix_k6 = false

# Stereo calibration criteria
stereo_max_iter = 100
stereo_epsilon = 1e-5

# Stereo calibration flags (for divergent cameras with minimal overlap)

# Trust individual calibrations completely, only solve for R and T (recommended for divergent cameras)
# USE: When individual calibrations are high quality and you only want extrinsics
# DON'T USE: If individual calibrations have errors or you want joint optimization
stereo_fix_intrinsic = true

# Fix focal length from individual calibrations (fx, fy)
# USE: With CALIB_FIX_INTRINSIC for maximum trust in individual calibrations
# DON'T USE: If you want stereo calibration to refine focal lengths
stereo_fix_focal_length = true

# Fix principal point from individual calibrations (cx, cy)
# USE: With CALIB_FIX_INTRINSIC for maximum trust in individual calibrations
# DON'T USE: If principal points may have shifted or need refinement
stereo_fix_principal_point = true

# Fix aspect ratio (fx/fy) for each camera
# USE: If your sensor has square pixels and you want to enforce this constraint
# DON'T USE: With CALIB_FIX_INTRINSIC (redundant), or if pixels are not square
stereo_fix_aspect_ratio = false

# Use provided camera matrices as initial guess (allows minor refinement)
# USE: When individual calibrations are good but may benefit from slight optimization
# DON'T USE: With CALIB_FIX_INTRINSIC (conflicts - that flag prevents refinement)
stereo_use_intrinsic_guess = false

# Enforce same focal length for both cameras (fx_left = fx_right, fy_left = fy_right)
# USE: If cameras use identical lenses and you want to enforce optical symmetry
# DON'T USE: With divergent cameras or different lens models (loses per-camera accuracy)
stereo_same_focal_length = false

# Set tangential distortion coefficients (p1, p2) to zero
# USE: If lenses have primarily radial distortion (wide-angle, fisheye)
# DON'T USE: If you have decentering distortion or need accurate distortion modeling
stereo_zero_tangent_dist = true

# Enable rational distortion model (8 coefficients: k1-k6, p1-p2)
# USE: For high-distortion lenses (fisheye, wide-angle) needing more accurate modeling
# DON'T USE: With standard lenses (5 coefficients sufficient), adds computational cost
stereo_rational_model = true

# Enable thin prism distortion model (s1, s2, s3, s4)
# USE: For lenses with manufacturing defects causing prism-like distortion
# DON'T USE: With standard lenses (rare to need this), increases complexity
stereo_thin_prism_model = false

# Enable tilted sensor model (tauX, tauY)
# USE: If sensor plane is tilted relative to lens (manufacturing defect or camera design)
# DON'T USE: With properly aligned cameras (standard case), rarely needed
stereo_tilted_model = false

# Fix individual radial distortion coefficients (k1-k6)
# USE: If you want to prevent specific coefficients from being optimized
# DON'T USE: With CALIB_FIX_INTRINSIC (already fixes all distortion), or if coefficients need refinement
stereo_fix_k1 = false
stereo_fix_k2 = false
stereo_fix_k3 = false
stereo_fix_k4 = false
stereo_fix_k5 = false
stereo_fix_k6 = false

# Output format
output_format = yaml

# Debug output
# Generate debug images (alpha comparisons, undistortion examples, overlap visualizations)
# USE: During calibration tuning to visualize results
# DON'T USE: For production/automated calibration to save time and disk space
generate_debug_images = true

# Performance
max_images = 40

[paths]
# Image folder paths
left_images = images/left
right_images = images/right
stereo_images = images/stereo
saves_folder = images/saves
calibration_output = calibration

# Calibration output files
left_calibration = left.npz
right_calibration = right.npz
left_fisheye_calibration = left_fisheye.npz
right_fisheye_calibration = right_fisheye.npz
stereo_calibration = stereo_calibration.npz

[preview]
# Preview settings
left_margin = 965
right_margin = 931
preview_scale = 3
